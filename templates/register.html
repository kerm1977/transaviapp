{% extends "base.html" %}
{% block title %}Registro de Usuario{% endblock %}

{% block content %}
<!-- Se reemplaza auth-container por un div simple que actúa como wrapper del formulario -->
<div class="register-form-wrapper">
    <h1 style="text-align: center; color: var(--clr-main); margin-bottom: 25px;">Crear Cuenta</h1>
    
    <form method="POST" action="{{ url_for('auth.register') }}">
        
        <!-- Nombre: Solo letras. Se aplica Title Case automáticamente. -->
        <div class="input-group">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre" value="{{ form_data.nombre or '' }}" 
                   pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ]+" 
                   oninput="validateName(this)" required>
        </div>

        <!-- Primer Apellido: Solo letras. Se aplica Title Case automáticamente. -->
        <div class="input-group">
            <label for="apellido1">Primer Apellido:</label>
            <input type="text" id="apellido1" name="apellido1" value="{{ form_data.apellido1 or '' }}" 
                   pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ]+" 
                   oninput="validateName(this)" required>
        </div>

        <!-- Segundo Apellido (Opcional): Solo letras. Se aplica Title Case automáticamente. -->
        <div class="input-group">
            <label for="apellido2">Segundo Apellido (Opcional):</label>
            <input type="text" id="apellido2" name="apellido2" value="{{ form_data.apellido2 or '' }}" 
                   pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ]*" 
                   oninput="validateName(this, false)">
        </div>

        <!-- Teléfono: Solo 8 dígitos. (Se mantiene el estilo sin icono para consistencia con la versión anterior) -->
        <div class="input-group">
            <label for="telefono">Teléfono (8 dígitos):</label>
            <input type="text" id="telefono" name="telefono" value="{{ form_data.telefono or '' }}" 
                   pattern="[0-9]{8}" 
                   oninput="validatePhone(this)" required>
        </div>

        <!-- Email: Validación básica de formato. (Se mantiene el estilo sin icono para consistencia con la versión anterior) -->
        <div class="input-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" value="{{ form_data.email or '' }}" 
                   oninput="validateEmail(this)" required>
        </div>

        <!-- Nombre de Usuario: Longitud 5-15, alfanumérico. (CON ICONO DE VALIDACIÓN DENTRO DEL INPUT) -->
        <div class="input-group">
            <label for="usuario">Nombre de Usuario (5-15 caracteres):</label>
            <!-- El icono de validación se coloca aquí, inmediatamente después del input -->
            <input type="text" id="usuario" name="usuario" value="{{ form_data.usuario or '' }}" 
                   pattern="[a-zA-Z0-9]{5,15}" 
                   oninput="validateUsername(this)" required>
            <span class="validation-icon" id="icon-usuario"></span>
        </div>
        
        <!-- Contraseña: Con eye-off para mostrar/ocultar. -->
        <div class="input-group">
            <label for="password">Contraseña (Mín. 8 caracteres):</label>
            <input type="password" id="password" name="password" 
                   minlength="8" 
                   oninput="checkPasswords()" required>
            <span class="toggle-password" onclick="togglePasswordVisibility('password')">
                <ion-icon name="eye-off-outline" id="icon-password-toggle"></ion-icon>
            </span>
        </div>

        <!-- Confirmar Contraseña: -->
        <div class="input-group">
            <label for="password_confirm">Confirmar Contraseña:</label>
            <input type="password" id="password_confirm" name="password_confirm" 
                   oninput="checkPasswords()" required>
            <span class="toggle-password" onclick="togglePasswordVisibility('password_confirm')">
                <ion-icon name="eye-off-outline" id="icon-password_confirm-toggle"></ion-icon>
            </span>
            <!-- Feedback de Contraseñas (Texto simple) -->
            <small id="password-feedback" style="margin-top: 5px; font-size: 0.9em; display: none;">Las contraseñas no coinciden.</small>
        </div>


        <button type="submit" class="btn-primary" id="register-button" disabled>Registrarme</button>
        
    </form>
    
    <p style="text-align: center; margin-top: 20px; font-size: 0.9em;">
        ¿Ya tienes una cuenta? 
        <a href="{{ url_for('auth.login') }}" style="color: var(--clr-main); text-decoration: none; font-weight: bold;">Inicia sesión aquí</a>
    </p>
</div>
{% endblock %}
